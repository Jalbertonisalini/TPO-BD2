version: '3.8'
services:
  # 1. El servicio para tu aplicaci√≥n Python
  app:
    build:
      context: ..
      dockerfile: Dockerfile
    # Comando para mantener el contenedor activo
    command: sleep infinity
    # Conecta tu carpeta de trabajo local con la del contenedor
    volumes:
      - ..:/workspace:cached
    # Indica que este servicio debe esperar a que las BBDD se inicien
    depends_on:
      - mongo
      - redis

  # 2. El servicio para la base de datos MongoDB
  mongo:
    image: mongo:latest
    ports:
      - "27017:27017" # Expone el puerto de Mongo
    volumes:
      - mongo-data:/data/db

  # 3. El servicio para la base de datos Redis
  redis:
    image: redis:latest
    ports:
      - "6379:6379" # Expone el puerto de Redis

# Define un volumen para que los datos de Mongo no se pierdan
volumes:
  mongo-data: